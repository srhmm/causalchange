from statistics import mean, stdev

import numpy as np
import pandas as pd
from matplotlib import pyplot as plt

from src.exp.exp_stime.data_hypparams import MONTH_NMS
RIVER_LOC_IDS = ['6935145', '6604150', '6606790', '6607115', '6457956', '6335350', '6607101', '6609110',
                       '6357502', '6607855', '6854800', '6606550', '6607100', '6934460', '6233250', '6934500',
                       '6242250', '6731920', '6144100', '6545200', '6607710', '6140600', '6144300', '6608190',
                       '6854590', '6342520', '6934310', '6457955', '6357501', '6606590', '6605700', '6338110',
                       '6608230', '6605310', '6233680', '6604230', '6607705', '6607711', '6604220', '6605300',
                       '6854620', '6605710', '6338100', '6606580', '6340050', '6142601', '6934300', '6335800',
                       '6604180', '6233450', '6731501', '6607500', '6457370', '6457210', '6935020', '6607110',
                       '6934100', '6607851', '6457985', '6607850', '6609100', '6158100', '6731070', '6609538',
                       '6609510', '6233150', '6340800', '6335290', '6139360', '6607200', '6335125', '6220500',
                       '6242420', '6123700', '6603310', '6140700', '6343500', '6457707', '6731610', '6854320',
                       '6142300', '6604250', '6457840', '6607765', '6605400', '6609560', '6605560', '6609400',
                       '6606900', '6731160', '6608520', '6545300', '6934400', '6731175', '6603110', '6140500',
                       '6605575', '6233350', '6457880', '6854900', '6603500', '6603510', '6607010', '6604280',
                       '6948120', '6607560', '6545700', '6603100', '6233220', '6605565', '6731165', '6608530',
                       '6605570', '6943100', '6606870', '6934571', '6605410', '6609570', '6607950', '6604240',
                       '6457850', '6233800', '6341500', '6337509', '6142660', '6608240', '6603300', '6606250',
                       '6337508', '6731601', '6233550', '6606720', '6934200', '6458753', '6607210', '6140300',
                       '6935320', '6607760', '6457860', '6608310', '6604270', '6140480', '6457280', '6337511',
                       '6337505', '6139220', '6337504', '6603330', '6337510', '6934350', '6605580', '6606710',
                       '6854301', '6140250', '6233400', '6606880', '6607220', '6935310', '6229100', '6606300',
                       '6233600', '6939500', '6607550', '6948110', '6157100', '6457320', '6603130', '6457240',
                       '6337506', '6607140', '6608501', '6337512', '6606510', '6935500', '6607800', '6608500',
                       '6142120', '6337513', '6337507', '6340200', '6125540', '6609540', '6608110', '6605420',
                       '6340610', '6731550', '6604500', '6604510', '6340600', '6608100', '6142520', '6605430',
                       '6606850', '6604100', '6128100', '6608510', '6337503', '6934800', '6458406', '6142680',
                       '6607150', '6337502', '6603120', '6246700', '6242200', '6607540', '6233360', '6140450',
                       '6608101', '6948100', '6144150', '6731555', '6935302', '6144350', '6934750', '6458203',
                       '6606890', '6607230', '6545050', '6604665', '6606700', '6335115', '6605590', '6603320',
                       '6337500', '6337501', '6142640', '6235100', '6457290', '6607225', '6608300', '6604260',
                       '6935400', '6934050', '6142551', '6607530', '6731900', '6457340', '6123150', '6335601',
                       '6457220', '6233700', '6607120', '6606570', '6246611', '6125440', '6604170', '6731685',
                       '6605520', '6609520', '6605440', '6608170', '6935401', '6336900', '6608600', '6605330',
                       '6457380', '6742912', '6340302', '6335602', '6731650', '6338130', '6608210', '6139240',
                       '6606200', '6603350', '6246612', '6243030', '6934250', '6607240', '6458924', '6935402',
                       '6604205', '6342925', '6604201', '6233100', '6939200', '6607250', '6342510', '6458713',
                       '6139640', '6603340', '6338120', '6608200', '6605730', '6605320', '6854210', '6731907',
                       '6243800', '6606401', '6731905', '6608160', '6731050', '6545190', '6606950', '6607131',
                       '6340700', '6607130', '6606560', '6457230', '6731680', '6934530', '6233300', '6607520',
                       '6731910', '6935410', '6606400']



contexts_river_01_jan = np.array([  0.,   1.,   1.,   1.,   2.,   1.,   1.,   1.,   3.,   1.,   4.,
         1.,   1.,   5.,   6.,   7.,   8.,   9.,   1.,   1.,  10.,  11.,
         1.,   1.,  12.,  13.,  14.,  15.,  16.,   1.,   1.,   0.,   1.,
         1.,  17.,   1.,  18.,  19.,   1.,   1.,  20.,   1.,  21.,  22.,
        23.,   1.,  14.,  24.,   1.,  15.,  25.,  26.,  27.,  28.,  24.,
         1.,  29.,   1.,  30.,   1.,   1.,   1.,   1.,   1.,   1.,   1.,
        31.,  26.,   1.,   1.,  32.,  18.,  33.,  34.,   1.,   1.,  35.,
        36.,  37.,  38.,   1.,   1.,  39.,   1.,  40.,   1.,   1.,   1.,
         1.,   1.,   1.,   1.,  14.,  41.,   1.,  42.,   1.,  43.,   1.,
        44.,   1.,   1.,  45.,   1.,  38.,   1.,  46.,   1.,  47.,   1.,
        48.,   1.,  46.,   1.,   1.,   1.,  49.,   1.,   1.,   1.,  50.,
        51.,  52.,  24.,  46.,   1.,  53.,  42.,  26.,  54.,  55.,   1.,
        56.,  57.,   1.,  13.,  58.,   1.,  59.,   1.,   1.,  13.,  60.,
        24.,  26.,   1.,  61.,   1.,   0.,  62.,   1.,   1.,  63.,  64.,
        13.,  65.,   1.,  24.,  66.,   1.,  67.,  68.,  69.,   1.,  70.,
        52.,   1.,  41.,  26.,   1.,  46.,  24.,   1.,  71.,  72.,   1.,
        24.,   0.,  24.,  73.,   1.,   1.,   1.,  74.,  75.,  76.,   1.,
         1.,   0.,   1.,   1.,   1.,   1.,  77.,  13.,   1.,  78.,  15.,
        24.,  79.,   1.,   1.,   1.,  80.,  81.,  82.,  83.,   3.,   1.,
        84.,   1.,  85.,  86.,   1.,  87.,   1.,  88.,   1.,  89.,   1.,
        90.,   1.,   1.,   1.,   1.,  24.,   1.,   1.,  91.,   1.,   1.,
        92.,  26.,   1.,  93.,   1.,  94.,  95.,   1.,  96.,  97.,  98.,
         1.,   1.,  99.,   1.,   1., 100.,   1.,   1.,   1.,   1., 101.,
       102.,   1.,   1., 103.,  24.,   1.,  24., 104.,  24.,   1., 105.,
       106.,   1., 107., 108., 109.,   1., 110.,  42.,   1., 111.,   1.,
         1., 112.,  18., 113., 114., 104.,   1.,   1.,   1.,   1.,   1.,
       115., 116.,   1.,   1.,   1.,   1., 117., 118.,   1.,   1., 116.,
         1.,   1., 119., 120.,   1., 121.,   2., 122.,   1.,   1.])

contexts_river_02_feb = np.array([  0.,   1.,   1.,   2.,   3.,   4.,   1.,   1.,   5.,   1.,   6.,
         1.,   5.,   7.,   8.,   9.,  10.,  11.,   5.,  12.,  13.,   1.,
        12.,   1.,  14.,   5.,   1.,  15.,   3.,   1.,   1.,  16.,   1.,
         1.,  17.,   1.,  18.,  19.,   3.,  20.,  21.,   1.,  22.,  23.,
         5.,  15.,   1.,  12.,   1.,  24.,   1.,   3.,   1.,  25.,  26.,
        27.,  28.,   5.,  29.,   1.,  30.,   5.,  31.,   1.,  32.,  33.,
         5.,  12.,   1.,  34.,   3.,   1.,   1.,   1.,   1.,  35.,  36.,
         3.,  37.,  38.,  39.,   1.,  40.,  41.,  42.,   1.,   5.,   3.,
         1.,  43.,  44.,  12.,   1.,  45.,   1.,   1.,   1.,  46.,   1.,
        47.,  48.,   1.,  49.,  50.,  51.,   1.,  52.,   1.,  53.,   3.,
        54.,   1.,  40.,  55.,   1.,  27.,  56.,  57.,   1.,   1.,   3.,
        58.,   1.,  12.,  12.,   1.,  59.,  60.,  61.,  62.,  63.,   1.,
         1.,   5.,   1.,   5.,   1.,   1.,  64.,   1.,   1.,   5.,   1.,
        12.,  65.,   1.,  66.,   1.,  67.,   1.,   1.,   1.,  68.,  12.,
        69.,  35.,   1.,  70.,  71.,   1.,  72.,  73.,  74.,   1.,  12.,
         1.,   1.,   1.,  61.,   5.,  75.,  12.,   1.,  76.,   1.,   1.,
        12.,  12.,  12.,  12.,   1.,   1.,   1.,  77.,   5.,  78.,  79.,
        41.,  12.,   3.,   5.,   1.,  48.,  34.,   5.,   1.,   1.,  80.,
        81.,  82.,  34.,   3.,  77.,  83.,   1.,  84.,  85.,  86.,   1.,
        87.,   1.,  88.,  89.,  15.,   1.,  15.,  90.,   1.,  91.,  41.,
         1.,  59.,   5.,   5.,  12.,  12.,  48.,   1.,  92.,   1.,  34.,
         1.,  12.,   1.,  15.,   1.,  37.,   1.,   1.,  93.,  94.,  95.,
         1.,  96.,  97.,   1.,   1.,  98.,   1.,  99.,   1.,   5.,   3.,
       100.,   1.,   5.,   1.,  52.,  77., 101., 102., 103.,   3.,   1.,
         1.,   1., 104., 105., 106.,   1.,   5.,  15.,   1., 107.,   3.,
       108., 109., 110., 111.,   5.,  41.,   1., 112.,   3.,   5.,   1.,
       113., 114.,   1.,   3., 115.,   1., 116.,   3.,   1.,   1.,   5.,
         3.,   1.,   1., 117.,   1., 118., 119., 120.,   1.,   3.])

contexts_river_03_mar =  np.array([  0.,   1.,   2.,   3.,   4.,   5.,   6.,   6.,   3.,   6.,   7.,
         8.,   3.,   3.,   3.,   9.,  10.,  11.,  12.,  13.,  14.,  15.,
         4.,   6.,  16.,  12.,   3.,   3.,   4.,  17.,   6.,  18.,  19.,
         3.,  20.,   3.,  21.,  22.,  23.,   3.,  24.,   6.,  25.,  26.,
        27.,   3.,   3.,  28.,   3.,  29.,   3.,  12.,  30.,  12.,   4.,
        31.,  12.,   3.,  32.,   3.,  33.,   3.,   3.,   3.,  34.,   3.,
        12.,   3.,   6.,   3.,  35.,  36.,   3.,   6.,   3.,   3.,  37.,
        38.,   3.,  39.,   3.,   3.,  40.,  41.,  42.,   3.,   3.,   3.,
        30.,   3.,  43.,  44.,  30.,   3.,  30.,   3.,   3.,   3.,   6.,
        45.,   3.,  46.,  47.,   3.,   3.,   6.,  48.,   3.,  49.,  50.,
         3.,  30.,   4.,   3.,  51.,  12.,  52.,  53.,   3.,   3.,   4.,
        54.,  55.,  56.,  57.,   3.,   3.,   3.,   3.,   4.,  58.,   3.,
         3.,  35.,   3.,  59.,   3.,   6.,   3.,  60.,   3.,  61.,  30.,
        62.,   4.,   3.,   3.,   8.,  25.,  63.,   6.,  51.,  64.,  18.,
        65.,  66.,   3.,  13.,   3.,   6.,   6.,  67.,  68.,   6.,   0.,
        69.,   6.,   3.,   3.,   3.,   4.,  70.,  71.,  72.,  73.,   3.,
        48.,  62.,  28.,  40.,   6.,  30.,   6.,  74.,  75.,   3.,   3.,
         6.,  76.,  77.,   3.,   6.,   3.,   3.,  12.,  78.,   3.,  79.,
        13.,  80.,   3.,  81.,   3.,   3.,  82.,  83.,   3.,   3.,   6.,
         3.,   3.,  84.,  85.,   3.,  79.,   3.,  86.,   3.,  87.,  46.,
        88.,   3.,   3.,   3.,   0.,  89.,  80.,  90.,   3.,   3.,   3.,
         3.,   3.,   3.,   3.,  91.,   6.,  92.,   6.,  93.,  94.,  95.,
         3.,  96.,  13.,  97.,   3.,  98.,   6.,  99.,   3.,   3.,   3.,
       100.,   6.,   3., 101., 102.,   4.,   0.,  46.,   0.,   3.,   3.,
       103.,   3.,  13., 104.,   3.,   6.,   3., 105.,   6., 106.,   3.,
         3., 107., 108.,  18.,  35., 109.,   3.,   4.,   3.,   3., 110.,
       111., 112.,   3.,   3., 113., 114.,   3.,   3.,   2.,   6.,  35.,
         3., 115., 116., 117.,   3.,  34., 118., 119.,   3.,  12.])

contexts_river_04_ap = np.array([ 0.,  1.,  1.,  1.,  1.,  1.,  1.,  2.,  1.,  1.,  3.,  1.,  1.,
        4.,  5.,  1.,  6.,  1.,  1.,  1.,  7.,  8.,  9.,  1.,  1., 10.,
        1., 11., 12., 13.,  1., 14.,  1.,  1., 15.,  1., 16., 17., 14.,
        1., 18.,  1.,  9., 19., 20.,  1.,  2., 14.,  1., 21., 14.,  1.,
        1.,  1., 22.,  2., 23.,  1., 24.,  1.,  1.,  1.,  1.,  1., 25.,
        1., 26.,  1.,  1.,  1.,  1., 27.,  1.,  1.,  1.,  1., 28.,  5.,
        1.,  3.,  1.,  1., 29., 30., 31.,  1.,  1.,  1.,  1.,  1.,  1.,
       32., 33., 34.,  1.,  1.,  1., 14.,  1., 35.,  1.,  1., 36.,  1.,
        1.,  1., 37.,  1., 38.,  1., 39.,  1.,  1.,  1., 40.,  1., 41.,
        1., 42.,  1., 12.,  1., 10.,  5.,  9.,  1., 43.,  1.,  1.,  5.,
        1., 44., 45., 39., 46., 12.,  1.,  1., 42.,  1.,  1.,  1., 47.,
        5., 48.,  1.,  1.,  1.,  9.,  1.,  1., 25.,  1.,  1.,  1., 49.,
        1.,  9.,  1.,  1., 50.,  9., 51.,  1.,  9.,  1., 52.,  1.,  1.,
        1.,  1., 14., 53., 37., 17.,  1., 54.,  5.,  1., 14.,  1.,  1.,
        1.,  1., 55.,  1.,  1.,  1., 56.,  1.,  1.,  1., 57.,  1.,  1.,
        1., 58., 42., 59., 60.,  1.,  1.,  1., 61., 62., 63., 64.,  1.,
        1.,  5.,  1., 65., 28.,  1.,  1.,  1.,  1.,  1., 66., 67., 68.,
        1.,  1.,  1.,  1.,  5., 69.,  1.,  1., 45.,  1.,  1., 60., 70.,
        1.,  1.,  1.,  1.,  1., 71., 39., 72.,  1., 73., 74.,  1.,  1.,
        1., 30., 17.,  1.,  1.,  1., 75.,  1.,  1., 57., 76.,  1., 77.,
        1., 78.,  1.,  1.,  1.,  1., 79.,  9., 80.,  1.,  1., 69.,  1.,
       81.,  1.,  1., 82., 83., 84., 61., 30.,  1.,  1.,  1.,  1.,  1.,
        1., 85., 86.,  1.,  1.,  1.,  1., 14.,  1.,  1., 87.,  1.,  1.,
        1., 88.,  1., 89., 90., 91.,  1.,  1.])

contexts_river_05_my = np.array([  0.,   1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,   4.,
        10.,  11.,  12.,   4.,  13.,  14.,  15.,   4.,  16.,  17.,  18.,
        19.,  20.,  21.,  22.,  23.,   4.,  24.,  25.,  26.,  16.,  27.,
        28.,  29.,   1.,  30.,  31.,  32.,  33.,  34.,  35.,   4.,  36.,
        37.,   8.,  38.,  39.,   1.,   4.,  15.,  40.,  28.,  41.,  42.,
        43.,  44.,  45.,  46.,  47.,  48.,   4.,   8.,  25.,  49.,  50.,
         8.,   5.,   1.,  51.,   8.,  52.,  52.,  53.,  30.,  54.,  55.,
        56.,   4.,   4.,   4.,  53.,  57.,  58.,  59.,  60.,  61.,  62.,
        26.,  63.,  25.,  64.,  65.,  66.,  28.,  67.,  68.,  69.,  70.,
         4.,   3.,  71.,  72.,  73.,   4.,  74.,  34.,  30.,   4.,  75.,
         4.,  76.,  67.,  77.,  78.,  79.,  26.,  80.,  81.,  53.,   4.,
         4.,  40.,   4.,  34.,  28.,   5.,  11.,   8.,  82.,  79.,  83.,
        84.,   4.,  68.,  39.,  18.,  47.,  18.,  85.,  53.,  66.,  86.,
         4.,  87.,  86.,  40.,  88.,  89.,  90.,  91.,  92.,   5.,  93.,
        94.,  95.,  96.,  97.,  98.,  26.,  99.,  34., 100., 101., 102.,
       103.,  53.,   4.,   8.,  73.,  16.,   4., 104.,  55.,  53., 105.,
       102.,   4.,   4.,   4.,   1., 106., 107., 108., 109.,   8.,  79.,
       110.,  89., 111.,   4., 112., 113., 101.,   4.,  27., 114., 115.,
       102., 116., 117.,  39., 101., 118., 119.,  28., 120., 101., 121.,
        34.,   8.,  82., 122.,  16., 123.,   4.,  27.,  28., 124., 125.,
        53.,   8.,  61., 126., 127., 128.,  16., 118.,  70., 129., 130.,
       131.,   4., 132.,   4., 133.,   4., 134., 135., 136., 109.,   4.,
       137., 138., 139., 140.,  28.,   4., 141., 106., 142., 143.,   4.,
         4., 107., 144.,  73.,   4., 145.,   4.,  86.,   8.,  40.,  86.,
        26.,  25., 139., 146., 147.,  80., 148.,   5., 149., 150., 151.,
       152., 153., 144., 154.,  66., 155., 156., 101.,  40., 157.,  26.,
       158.,  15.,   1.,  79.,   4.,  76.,   4., 159.,  76.,  27., 101.,
       160.,  26., 161.,   4.,   1.,  26., 162.,  15.,  63.,  40.])

contexts_river_06_june = np.array([  0.,   1.,   2.,   3.,   4.,   4.,   5.,   6.,   4.,   5.,   4.,
         7.,   8.,   9.,   4.,   6.,  10.,  11.,   4.,   4.,  12.,   4.,
        13.,   1.,  14.,  15.,  16.,  17.,   4.,  18.,  16.,  19.,  20.,
         1.,  10.,   1.,  21.,  22.,  23.,  15.,   4.,   5.,  24.,  25.,
        26.,   4.,  27.,  28.,   1.,  29.,  30.,  31.,  32.,  33.,  34.,
         6.,  35.,  36.,  37.,   5.,  38.,   4.,  17.,   1.,  39.,  17.,
         4.,   4.,   1.,  40.,  41.,  42.,  43.,   6.,  44.,  45.,  46.,
        47.,  48.,   4.,   4.,   5.,  49.,  50.,  51.,  52.,  43.,  53.,
        16.,  54.,  55.,   4.,  56.,  57.,  58.,   4.,  59.,   4.,   1.,
         4.,   1.,  60.,  61.,  62.,   4.,  63.,  64.,  65.,   4.,  66.,
        67.,  16.,   4.,  68.,  69.,  15.,  70.,   6.,  71.,  16.,   4.,
         4.,  72.,  73.,  74.,  27.,  75.,  76.,   4.,  77.,  71.,  71.,
        78.,  79.,   3.,   4.,   4.,   5.,  17.,  80.,  81.,   4.,   1.,
         4.,   4.,  56.,  82.,  83.,  48.,  84.,  85.,  86.,   4.,   4.,
        87.,  55.,  88.,  89.,  90.,  16.,  78.,  91.,  92.,  93.,  94.,
        95.,   5.,  17.,   4.,   1.,   4.,  96.,  69.,  46.,  97.,   1.,
        13.,  29.,   4.,  96.,   1.,   6.,  98.,  53.,  53.,  99., 100.,
       101.,  94., 102.,   4.,  16., 103., 104., 105., 106.,   1., 107.,
        13.,   4.,   1.,   4., 108.,  28.,   6., 109., 110.,   4., 111.,
       112.,   4.,  30., 113.,   4.,  45.,   4., 114.,  27.,  30., 115.,
       116.,   4.,  82.,  62.,  28.,   4.,   4.,   4., 117.,  62., 118.,
         1.,   4., 119.,   4., 120.,   4.,   1., 121., 122., 123.,   4.,
         3., 124., 125.,   6.,   6.,  28., 126.,  97., 109.,   8.,   4.,
         4.,   6.,  44.,   1.,  47.,  28.,   4.,   8., 104.,  66.,   1.,
        16., 127., 128., 129., 130., 131.,   4.,   4., 132.,  10.,  53.,
         4., 133., 134., 128.,  96.,  69.,   1.,  15.,  82., 135., 136.,
       137., 138., 135.,  82., 139.,   6.,  96.,  48.,  16.,   1.,   4.,
        43., 140.,  45.,   4., 141.,  60., 142.,  11.,   4., 143.])

contexts_river_07_july = np.array([  0.,   1.,   2.,   3.,   4.,   5.,   6.,   7.,   1.,   8.,   5.,
         9.,   1.,  10.,   1.,  11.,  12.,  13.,   1.,  14.,  15.,   1.,
        16.,   1.,  17.,  18.,  19.,  20.,   1.,  21.,   6.,  22.,  23.,
         1.,  24.,   1.,  25.,  26.,  27.,   1.,   1.,   6.,  28.,  29.,
        30.,   1.,  31.,   1.,   1.,  32.,  33.,  34.,  35.,  36.,  37.,
        38.,  39.,  40.,  41.,  11.,  42.,  43.,   1.,   1.,  44.,  45.,
         1.,  46.,  47.,   1.,  48.,  49.,   1.,   6.,   1.,   1.,  50.,
        51.,  52.,   1.,   1.,   1.,  53.,  44.,  54.,  55.,   1.,   1.,
        56.,   1.,  57.,  58.,  59.,  60.,   1.,   1.,   1.,   1.,  61.,
        62.,   1.,   6.,  63.,   1.,   1.,  64.,  17.,   1.,   1.,   1.,
        65.,  66.,   1.,  67.,  68.,  69.,  70.,   2.,  71.,   1.,  72.,
         1.,  73.,  74.,  75.,  76.,   1.,  77.,  78.,  13.,   1.,  79.,
        80.,  14.,   3.,  81.,   1.,   6.,  82.,   6.,   1.,   1.,  23.,
        83.,  84.,  85.,  86.,   1.,  87.,  88.,  89.,  90.,  88.,   1.,
        91.,  92.,  93.,  94.,  95.,  96.,  23.,  97.,  98.,  99., 100.,
       101.,   1., 102.,   5.,   1.,   1., 103., 104., 105.,  66.,   1.,
        16., 106., 107., 108.,   6., 109.,  38., 110., 111.,   1.,   1.,
         1., 112.,   1., 113., 114., 115.,  32., 116.,  66.,   3., 117.,
        33., 118.,   1., 119.,   1., 120.,  23., 121., 122.,   1.,   1.,
       123., 124., 125., 126.,   1., 127.,   1., 128.,  21., 129.,   6.,
       130.,   1.,   1.,   1.,  41.,  14.,   1.,   1., 131.,   3.,   1.,
         1.,   1., 132.,   1.,  44.,   1., 133.,  44., 134., 135.,   1.,
         3., 136., 137.,   9.,   1., 138.,  66., 109.,   1.,   1.,   1.,
        32.,   1.,   1.,  23., 139., 140., 141.,  86.,   1.,   1., 142.,
       143.,   1., 144., 145., 146., 147.,  18.,   1.,   1., 148.,   1.,
         1., 145., 149., 150., 151., 152.,   1., 153.,   1.,   1.,   6.,
       154., 155.,   1.,   1.,  65.,   1.,   1., 156.,  96.,   1.,   1.,
         1., 157.,  45.,  75., 158.,  44., 159., 160.,   1.,   1.])

contexts_river_08_au = np.array([  0.,   1.,   2.,   3.,   4.,   1.,   3.,   3.,   5.,   6.,   1.,
         6.,   1.,   1.,   1.,   3.,   0.,   7.,   1.,   1.,   8.,   9.,
        10.,   1.,  11.,   1.,   6.,  12.,   5.,   3.,  13.,   1.,   3.,
         1.,  14.,   1.,  15.,  16.,   1.,   1.,   1.,  13.,   1.,  17.,
        18.,   1.,  19.,   5.,   1.,   1.,   1.,  20.,   6.,  21.,  22.,
        23.,   1.,  24.,  25.,  26.,  27.,  28.,  29.,   3.,  30.,   1.,
         1.,   1.,   3.,   1.,   1.,   1.,   1.,  31.,  32.,   1.,  33.,
         5.,   1.,   1.,   1.,   3.,  34.,  35.,  36.,   3.,   1.,   1.,
        37.,   1.,  19.,   1.,  38.,  39.,   3.,   1.,  40.,   1.,  19.,
        39.,  32.,  41.,  26.,   1.,   1.,  13.,   1.,  32.,   1.,   1.,
         1.,  38.,   1.,  42.,   6.,   3.,  43.,  44.,   3.,   3.,  45.,
        46.,   3.,  45.,   5.,  47.,  48.,   3.,   1.,  49.,   3.,   3.,
        50.,   1.,   3.,   1.,   1.,   3.,   1.,   3.,   3.,   1.,  51.,
         1.,   1.,  52.,   1.,  53.,  54.,  55.,  13.,  56.,   1.,   1.,
         5.,  57.,   3.,  58.,   1.,   3.,  59.,  60.,  61.,  62.,   1.,
         1.,   3.,  63.,   1.,   1.,   1.,   1.,  26.,  64.,  44.,   1.,
        65.,   1.,  66.,  67.,  26.,  68.,  23.,  69.,   1.,  19.,   1.,
        70.,  71.,   1.,   1.,  44.,   3.,  72.,  73.,  13.,  74.,   3.,
        49.,  75.,   1.,  73.,   1.,  76.,   3.,  77.,  67.,   1.,   3.,
        78.,  79.,  80.,  81.,   1.,   3.,   1.,  82.,  83.,  71.,   3.,
        84.,   1.,   1.,   1.,  85.,   1.,   1.,   1.,  86.,   3.,   1.,
         1.,   5.,  87.,   1.,  35.,   1.,   2.,  88.,  89.,  90.,  91.,
         3.,  41.,  92.,  26.,   1.,   1.,   3.,   2.,   3.,   1.,   5.,
         1.,  47.,   3.,  37.,   5.,  10.,  93.,   3.,   1.,   1.,  26.,
        26.,  32.,  94.,  95.,   1.,  44.,   1.,   1.,  19.,  96.,  21.,
         5.,  97.,  51.,  98.,  45.,  99.,   1.,   1.,   1.,   1., 100.,
        62., 101.,   1.,   1.,   1.,   1.,   1.,   1.,   3.,  44.,  28.,
         1., 102.,   1.,   1., 103., 104., 105.,  49.,   1.,   1.])


contexts_river_09_sep = np.array([  0.,   1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,   1.,
        10.,   1.,   3.,  11.,  12.,  13.,  14.,  11.,  15.,  16.,   1.,
        17.,   1.,  18.,   1.,  19.,  20.,  21.,  22.,  23.,  24.,  25.,
         1.,  26.,   1.,  27.,  28.,  29.,   1.,  11.,   6.,  30.,  31.,
        32.,   1.,  33.,  34.,   1.,   1.,  35.,  36.,  37.,  38.,   0.,
        37.,   5.,  39.,  40.,  41.,   1.,   8.,   1.,  42.,  43.,   1.,
        44.,   1.,   6.,   1.,   1.,  45.,  46.,   6.,   1.,   1.,  47.,
        24.,   1.,   1.,   1.,   1.,  48.,  49.,  50.,  51.,   1.,  32.,
        52.,   1.,  53.,  35.,  54.,   1.,   1.,   1.,  55.,  56.,   1.,
         1.,   1.,   6.,  57.,   1.,   1.,  58.,  59.,   1.,   1.,   1.,
        29.,   1.,  11.,  24.,  60.,   1.,  61.,  62.,  63.,   1.,  64.,
         1.,  65.,  21.,  66.,   1.,  67.,  68.,   1.,  69.,  70.,  71.,
        72.,  73.,  74.,   4.,   1.,   6.,   1.,  70.,  70.,   8.,  70.,
        75.,   1.,  76.,   1.,  70.,  24.,   1.,  77.,  78.,   1.,   8.,
         4.,  79.,  80.,  81.,  82.,   6.,  83.,  84.,  85.,   1.,  35.,
        86.,   1.,   1.,   1.,   1.,  29.,   8.,  87.,  88.,  89.,   1.,
        35.,  21.,  21.,  90.,  91.,  92.,   6.,   1.,  93.,   1.,   1.,
         6.,  30.,  11.,  94.,   6.,  95.,  11.,  96.,  97.,  25.,  42.,
        98.,  21.,  99.,  44.,  35., 100.,  70., 101., 102.,   1.,   1.,
        24.,  99., 103., 104.,   1.,   1.,  11., 105., 106., 107.,   6.,
       105.,  11.,   1.,   1., 108.,  24.,   8.,   1.,  70.,  70.,   1.,
         1.,  29., 109.,   1., 110.,   1., 111., 112.,  24., 113.,   1.,
       114.,  23., 115., 116.,   1.,  11.,   6., 117.,   1.,  11.,  11.,
        21.,   1.,   1.,   7.,  75.,  24.,  75.,  22.,  75.,  29.,   6.,
       118.,   1.,   0., 119., 120., 121.,  29.,   1.,  70., 104.,   1.,
        35., 122., 123., 124., 125.,  41.,   1.,   1.,  11.,   1., 126.,
       100., 127., 128., 129.,   1.,   1.,   1.,  35.,  89.,  19.,  44.,
         1., 130., 131., 132., 133., 134., 135., 136.,   1.,  99.])


contexts_river_10_oct = np.array([  0.,   1.,   2.,   1.,   3.,   4.,   5.,   6.,   3.,   7.,   8.,
         9.,   1.,  10.,   3.,  11.,   0.,  12.,   1.,   8.,  13.,   1.,
        14.,   1.,  15.,  16.,  17.,   1.,   8.,  18.,  19.,  14.,   5.,
         1.,  20.,   1.,   5.,  21.,  22.,   3.,   3.,  19.,  23.,  24.,
        25.,   1.,   5.,  14.,   1.,  26.,  27.,   1.,   5.,   1.,  28.,
         5.,  29.,   1.,  30.,  31.,   1.,   1.,   1.,   1.,  32.,   1.,
        14.,   1.,  33.,   1.,   1.,  34.,  35.,  19.,   1.,   1.,  36.,
         8.,   1.,   3.,   1.,   1.,  37.,   7.,  38.,   5.,   1.,   1.,
        19.,   1.,   1.,  14.,   5.,  39.,   5.,   1.,   1.,   1.,   5.,
        40.,   1.,   7.,  41.,   1.,   1.,   7.,   3.,  42.,   1.,   1.,
        40.,   1.,   3.,  43.,  44.,  45.,  46.,  19.,  47.,   1.,   3.,
         1.,  48.,  14.,   8.,   1.,   1.,  49.,   1.,  50.,  51.,  52.,
        53.,   3.,   5.,  54.,   1.,  55.,   1.,   5.,   1.,   3.,   5.,
        56.,   3.,  41.,   1.,  18.,  57.,   1.,  19.,  32.,   3.,  14.,
         3.,   5.,   1.,  58.,  59.,  19.,  60.,  61.,  62.,  63.,  43.,
         1.,   5.,  64.,   1.,   1.,  43.,  65.,  24.,  66.,  67.,   1.,
         8.,  68.,  57.,  69.,  70.,   5.,   5.,   1.,  71.,   1.,   1.,
         5.,  72.,   1.,  73.,   5.,   5.,  73.,   1.,   7.,   5.,   1.,
         8.,   3.,   1.,  40.,   1.,  74.,  18.,  75.,  76.,   1.,   5.,
        57.,  77.,  78.,  79.,  80.,  81.,   1.,  82.,   5.,  83.,  19.,
        84.,   1.,   1.,   1.,  85.,   8.,   1.,   1.,   1.,   5.,   1.,
         1.,   3.,   5.,   1.,   7.,   1.,  86.,   7.,  57.,  87.,  73.,
         1.,   7.,  88.,  32.,   1.,  40.,   5.,  33.,   1.,   1.,   3.,
        14.,   1.,   1.,  89.,  43.,  40.,   3.,   5.,  90.,   3.,  91.,
        92.,   1.,  20.,  93.,  94.,  55.,   1.,   1.,  53.,  95.,   3.,
        43.,  96.,  97.,  98.,  99.,  41.,   1.,   1.,   3.,   1.,   5.,
       100.,   8.,  13., 101.,   1.,   1.,   1.,  57.,  19.,   5.,   8.,
         1., 102.,   1.,   1.,   5., 103., 104., 105.,   1.,   1.])


contexts_river_12_dec = np.array([  0.,   1.,   2.,   1.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,
        10.,  11.,   1.,  12.,   1.,  13.,  14.,  15.,  16.,  17.,  18.,
        19.,   1.,  20.,   4.,  21.,  22.,  23.,   1.,   1.,  19.,  24.,
        25.,  26.,   1.,  27.,  28.,  29.,   4.,  30.,  21.,  31.,   6.,
        32.,  25.,   1.,  19.,   1.,  33.,  18.,  34.,  35.,  36.,  19.,
        21.,  37.,  38.,  39.,  21.,  40.,  25.,  41.,   1.,  42.,  11.,
        43.,   4.,  38.,  44.,   4.,  45.,  21.,   1.,  38.,   1.,  46.,
        23.,  47.,  48.,  49.,   1.,  50.,  51.,  52.,  53.,  25.,  54.,
        21.,   1.,  55.,  56.,   1.,  45.,   1.,  57.,  38.,  58.,   1.,
        59.,   1.,  60.,  51.,  61.,  59.,   6.,  62.,   1.,  63.,  25.,
        64.,   1.,   4.,  58.,  65.,  66.,  67.,   6.,   1.,   1.,  68.,
         1.,  69.,  19.,  70.,  71.,  19.,  72.,   7.,  73.,   6.,   1.,
         1.,   7.,  74.,  25.,  25.,  75.,  76.,  77.,  21.,  78.,  79.,
        23.,  25.,   1.,  25.,   1.,  80.,  81.,  21.,  82.,  11.,  19.,
        40.,  83.,   1.,   0.,  84.,  85.,  86.,  87.,  88.,   1.,  19.,
        89.,   1.,  90.,   7.,  91.,  78.,  29.,  92.,  93.,   6.,   1.,
        70.,  19.,  23.,  94.,  95.,  96.,  97.,   4.,  98.,  99.,  25.,
         6., 100.,  57., 101.,   1.,  21.,  25.,  32., 102., 103., 104.,
       105.,   7.,  81., 106.,   4.,  59.,  21., 107.,   0.,  25.,  65.,
        29.,  25., 108., 109.,  25.,   1.,  25., 110., 111., 112.,   6.,
       113.,   4.,  25.,  25.,  78.,  19.,  25.,  38.,  59., 114., 115.,
         1.,   4.,   1.,  25., 116.,  38., 117.,   1.,  62., 118., 119.,
       120.,  65., 121., 116.,  21., 122., 123., 124.,   1.,  59.,   4.,
        62.,  21.,  25.,   1.,  19.,  19., 125.,  85.,   4., 126.,   1.,
       127.,  38.,  50., 128., 129.,   6., 130.,  25.,   1., 131.,  25.,
         4., 131.,  74., 132., 133.,   6.,  91.,   4.,  57.,  25.,   1.,
       134., 135.,   1., 136.,   1.,  21., 137.,  19.,   6.,  77.,  23.,
        25., 138., 139.,   1., 140., 141., 142., 143.,  91.,  34.])

contexts_river_11_nov = np.array([ 0.,  1.,  2.,  1.,  1.,  1.,  3.,  3.,  4.,  3.,  1.,  5.,  1.,
        6.,  1.,  3.,  7.,  8.,  1.,  1.,  9., 10.,  1.,  1., 11.,  1.,
       12.,  1., 13.,  3.,  3.,  1.,  3.,  1., 14.,  1.,  3., 15., 16.,
        1.,  1.,  3., 17., 18., 19.,  1.,  3.,  1.,  1.,  1.,  1.,  1.,
        3., 20., 21.,  3., 22.,  1., 23.,  3.,  1., 24.,  1.,  1., 18.,
       19., 25.,  1.,  1.,  1., 26.,  1., 27.,  3.,  1.,  1., 28., 29.,
        1.,  1.,  1.,  1., 29.,  3., 30.,  3.,  1.,  1.,  3.,  1., 31.,
        1., 32.,  1.,  1.,  1.,  1., 24.,  3.,  1.,  1.,  3., 18.,  1.,
        1.,  3.,  1.,  1.,  3.,  1.,  1.,  1.,  1., 33.,  3., 34., 35.,
       36.,  3.,  1., 25., 37.,  1.,  1.,  1.,  1., 38., 39.,  1., 40.,
       41.,  6., 42., 22.,  1., 43.,  1.,  3., 44.,  3.,  1.,  1.,  3.,
        1., 33.,  3.,  1.,  1., 45., 46.,  3., 47.,  1., 33., 48.,  3.,
        1., 49., 50.,  3., 51.,  0., 52., 53.,  1.,  1., 54.,  1.,  1.,
        1., 40.,  1., 55., 28., 56.,  1., 57.,  1.,  1.,  1.,  3., 51.,
        1., 26., 58.,  1.,  1.,  1.,  1.,  1.,  1.,  3.,  3.,  1., 19.,
       30.,  3., 59., 60.,  1.,  1., 61.,  1., 62., 51., 63.,  1., 64.,
        1., 21.,  1., 65., 66.,  1.,  1., 67., 68.,  3., 69.,  3., 70.,
        1.,  1.,  1.,  1., 71.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 72.,
        1.,  3.,  3.,  1.,  3.,  1., 26., 50.,  1., 30., 49., 30.,  1.,
        1.,  1., 73.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 13.,  1.,  1.,
        3.,  1.,  1.,  1., 74.,  1., 75., 76., 77.,  3., 78.,  1.,  1.,
       79., 80., 81., 82.,  3., 83., 84., 30.,  1.,  1.,  1.,  1.,  1.,
       85., 86.,  3.,  1.,  1.,  1.,  1., 87.,  3.,  1.,  1.,  1., 18.,
        1., 88., 89., 90., 91., 92.,  1.,  1.])

def _show():
    basins_info = pd.read_csv('../basin data/basins_info.csv')

    interesting_cnm = RIVER_LOC_IDS
    print(f'*** SIMILAR LOCATIONS ***')
    clusters = []

    for regime in np.unique(contexts_river_01_jan):
        contexts_in_regime = [ci for ci, x in enumerate(contexts_river_01_jan) if x == regime]
        ids_in_regime = [int(interesting_cnm[ci]) for ci, x in enumerate(contexts_river_01_jan) if x == regime]
        if len(contexts_in_regime) > 2:

            print(f'\tRegime {int(regime)}:')  # [(ci, interesting_cnm[ci]) for ci in contexts_in_regime])
            filter = [row for row in basins_info['id'] if
                          row in ids_in_regime]
            rows= basins_info[basins_info['id'].isin(filter)]

            for ci in contexts_in_regime:
                row = basins_info.loc[basins_info['id'] == int(interesting_cnm[ci])]
                print(
                    f"\t\tLoc. {ci}, {interesting_cnm[ci]}: ({float(row['lon']):.2f},{float(row['lat']):.2f}), area {float(row['area']):.2f}, altitude s {float(row['altitude_station']):.2f}, altitude b {float(row['altitude_basin']):.2f}, slope {float(row['slope']):.2f}")
            print(
                f"\t\tOverall: area ({float(mean(rows['area'])):.2f}, altitude s {float(mean(rows['altitude_station'])):.2f}, altitude b {float(mean(rows['altitude_basin'])):.2f}, slope {float(mean(rows['slope'])):.2f}")

            clusters.append(contexts_in_regime)

    for month_nm, month_result in zip(
            MONTH_NMS[:8],
            [contexts_river_01_jan, contexts_river_02_feb, contexts_river_03_mar, contexts_river_04_ap,
             contexts_river_05_my, contexts_river_06_june, contexts_river_07_july, contexts_river_08_au]):
        clusters = []
        print(f'Month {month_nm}')
        for regime in np.unique(month_result):
            contexts_in_regime = [ci for ci, x in enumerate(month_result) if x == regime]
            ids_in_regime = [int(interesting_cnm[ci]) for ci, x in enumerate(month_result) if x == regime]
            if len(contexts_in_regime) > 2:

                print(f'\t\tRegime {int(regime)}:')  # [(ci, interesting_cnm[ci]) for ci in contexts_in_regime])
                filter = [row for row in basins_info['id'] if
                          row in ids_in_regime]
                rows = basins_info[basins_info['id'].isin(filter)]

                for ci in contexts_in_regime:
                    row = basins_info.loc[basins_info['id'] == int(interesting_cnm[ci])]
                    # print(
                    #    f"\t\tLoc. {ci}, {interesting_cnm[ci]}: ({float(row['lon']):.2f},{float(row['lat']):.2f}), area {float(row['area']):.2f}, altitude s {float(row['altitude_station']):.2f}, altitude b {float(row['altitude_basin']):.2f}, slope {float(row['slope']):.2f}")
                print(
                    f"\t\t\tArea ({min(rows['area'])}-{max(rows['area'])}) \t\t{float(mean(rows['area'])):.2f}\t {stdev(rows['area']):.2f},{stdev(basins_info['area']):.2f}, \n\t\taltitude s ({min(rows['altitude_station'])}-{max(rows['altitude_station'])}) \t\t {float(mean(rows['altitude_station'])):.2f},\t {stdev(rows['altitude_station']):.2f},{stdev(basins_info['altitude_station']):.2f},  \n\t\taltitude b ({min(rows['altitude_basin'])}-{max(rows['altitude_basin'])}) \t\t {float(mean(rows['altitude_basin'])):.2f},\t {stdev(rows['altitude_basin']):.2f},{stdev(basins_info['altitude_basin']):.2f},  \n\t\tslope({min(rows['slope'])}-{max(rows['slope'])}) \t\t  {float(mean(rows['slope'])):.2f}\t {stdev(rows['slope']):.2f},{stdev(basins_info['slope']):.2f}, ")

                clusters.append(contexts_in_regime)
        print(f'\tMonth {month_nm} n.clusters: {len(clusters)}')


    clusters = {}
    for month_nm, month_result in zip(
            MONTH_NMS,
            [contexts_river_01_jan, contexts_river_02_feb, contexts_river_03_mar, contexts_river_04_ap,
             contexts_river_05_my, contexts_river_06_june, contexts_river_07_july, contexts_river_08_au
                , contexts_river_09_sep, contexts_river_10_oct, contexts_river_11_nov, contexts_river_12_dec]):
        cluster_regimes = {}
        print(f'Month {month_nm}')
        for regime in np.unique(month_result):
            contexts_in_regime = [ci for ci, x in enumerate(month_result) if x == regime]
            ids_in_regime = [int(interesting_cnm[ci]) for ci, x in enumerate(month_result) if x == regime]
            if len(contexts_in_regime) > 2:
                print(f'\t\tRegime {int(regime)}:',
                      contexts_in_regime)  # [(ci, interesting_cnm[ci]) for ci in contexts_in_regime])
                filter = [row for row in basins_info['id'] if
                          row in ids_in_regime]
                rows = basins_info[basins_info['id'].isin(filter)]
                # for ci in contexts_in_regime:
                #    row = basins_info.loc[basins_info['id'] == int(interesting_cnm[ci])]
                # print(
                #    f"\t\tLoc. {ci}, {interesting_cnm[ci]}: ({float(row['lon']):.2f},{float(row['lat']):.2f}), area {float(row['area']):.2f}, altitude s {float(row['altitude_station']):.2f}, altitude b {float(row['altitude_basin']):.2f}, slope {float(row['slope']):.2f}")
                print(
                    f"\t\t\tArea ({min(rows['area'])}-{max(rows['area'])}) \t\t{float(mean(rows['area'])):.2f}\t {stdev(rows['area']):.2f},{stdev(basins_info['area']):.2f}, \n\t\taltitude s ({min(rows['altitude_station'])}-{max(rows['altitude_station'])}) \t\t {float(mean(rows['altitude_station'])):.2f},\t {stdev(rows['altitude_station']):.2f},{stdev(basins_info['altitude_station']):.2f},  \n\t\taltitude b ({min(rows['altitude_basin'])}-{max(rows['altitude_basin'])}) \t\t {float(mean(rows['altitude_basin'])):.2f},\t {stdev(rows['altitude_basin']):.2f},{stdev(basins_info['altitude_basin']):.2f},  \n\t\tslope({min(rows['slope'])}-{max(rows['slope'])}) \t\t  {float(mean(rows['slope'])):.2f}\t {stdev(rows['slope']):.2f},{stdev(basins_info['slope']):.2f}, ")

                cluster_regimes[regime] = rows
        clusters[month_nm] = cluster_regimes
        print(f'\tMonth {month_nm} n.clusters: {len(clusters)}')

        mnth = 'Jan'
        for mnth in MONTH_NMS:
            dff = clusters[mnth]
            colors = plt.cm.get_cmap('tab10', len(dff))
            for i, reg in enumerate(dff):
                df = dff[reg]
                plt.scatter(df['lon'], df['lat'], color=colors(i), label=f'C. {int(reg)}', alpha=0.7)
            # Add labels and title
            plt.xlabel('Lon')
            plt.ylabel('Lat')
            plt.title(f'Month {mnth}')
            plt.legend()
            plt.savefig(f"map_contexts_{mnth}")

            plt.close()